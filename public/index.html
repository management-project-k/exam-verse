<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <title>Exam Verse – Student Registration</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    :root {
      --primary-blue: #1a73e8; 
      --error-red: #dc3545; 
      --success-green: #28a745;
      --light-bg: #ffffff; 
      --dark-bg: #181818; 
      --dark-gray: #2a2a2a;
      --transition: all 0.3s ease;
    }
    body { 
      font-family: 'Poppins', sans-serif; 
      background: var(--light-bg); 
      color: #333; 
      min-height: 100vh; 
    }
    body.dark { 
      background: var(--dark-bg); 
      color: #fff; 
    }
    .register-page { 
      min-height: 100vh; 
      display: flex; 
      flex-direction: column; 
      position: relative; 
    }
    
    .theme-toggle {
      position: absolute;
      top: 20px; right: 20px;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(8px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      cursor: pointer;
      width: 52px; height: 52px;
      display: flex; align-items: center; justify-content: center;
      border-radius: 50%;
      transition: var(--transition);
      z-index: 100;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .theme-toggle:hover {
      background: rgba(26,115,232,0.2);
      transform: scale(1.05);
    }
    body.dark .theme-toggle {
      background: rgba(255, 255, 255, 0.1);
      border-color: rgba(255, 255, 255, 0.3);
    }
    .theme-icon {
      width: 28px; height: 28px;
      position: absolute;
      transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
      color: var(--primary-blue);
    }
    .sun-icon { opacity: 1; transform: rotate(0deg); }
    body.dark .sun-icon { opacity: 0; transform: rotate(180deg); }
    .moon-icon { opacity: 0; transform: rotate(-180deg); }
    body.dark .moon-icon { opacity: 1; transform: rotate(0deg); }

    .register-main { 
      flex: 1; 
      display: flex; 
      align-items: center; 
      justify-content: center; 
      padding: 60px 20px 40px; 
    }
    .register-card { 
      width: 100%; 
      max-width: 480px; 
      padding: 40px; 
      border-radius: 20px; 
      box-shadow: 0 20px 60px rgba(0,0,0,0.1); 
      background: rgba(255,255,255,0.95); 
      backdrop-filter: blur(10px); 
      border: 1px solid rgba(255,255,255,0.2); 
      animation: slideUp 0.6s ease-out; 
    }
    body.dark .register-card { 
      background: rgba(42,42,42,0.95);
      box-shadow: 0 20px 60px rgba(0,0,0,0.3); 
    }
    @keyframes slideUp { 
      from { opacity: 0; transform: translateY(50px); } 
      to { opacity: 1; transform: translateY(0); } 
    }
    .register-card h2 { 
      text-align: center; 
      color: var(--primary-blue); 
      font-size: 28px; 
      font-weight: 600; 
      margin-bottom: 8px; 
    }
    .version-capsule { 
      display: block; 
      width: fit-content; 
      margin: 0 auto 24px; 
      padding: 6px 16px; 
      background: rgba(26,115,232,0.1); 
      color: var(--primary-blue); 
      font-size: 11px; 
      font-weight: 600; 
      letter-spacing: 1.5px; 
      text-transform: uppercase; 
      border-radius: 50px; 
    }
    .form-group { 
      display: flex; 
      flex-direction: column; 
      gap: 8px; 
      margin-bottom: 20px; 
    }
    .form-group label { 
      font-weight: 500; 
      font-size: 14px; 
    }
    .form-group input, 
    .form-group select { 
      padding: 14px 16px; 
      border: 2px solid rgba(0,0,0,0.1); 
      border-radius: 8px; 
      font-family: 'Poppins', sans-serif; 
      font-size: 16px; 
      transition: var(--transition); 
      background: white;
    }
    body.dark .form-group input, 
    body.dark .form-group select { 
      background: var(--dark-gray); 
      color: #fff; 
      border-color: rgba(255,255,255,0.1); 
    }
    .form-group input:focus, 
    .form-group select:focus { 
      outline: none; 
      border-color: var(--primary-blue); 
      box-shadow: 0 0 0 3px rgba(26,115,232,0.1); 
    }
    .form-group.fixed { 
      background: rgba(26,115,232,0.1); 
      padding: 14px 16px; 
      border-radius: 8px; 
      border: 2px solid var(--primary-blue); 
    }
    body.dark .form-group.fixed { 
      background: rgba(26,115,232,0.2); 
    }
    .error-message { 
      color: var(--error-red); 
      font-size: 12px; 
      display: none; 
      margin-top: 4px; 
    }
    .error-message.show { 
      display: block; 
    }
    .register-btn { 
      width: 100%; 
      padding: 16px; 
      background: var(--primary-blue); 
      color: white; 
      border: none; 
      border-radius: 8px; 
      font-weight: 600; 
      cursor: pointer; 
      transition: var(--transition); 
      margin-top: 8px; 
      font-size: 16px;
    }
    .register-btn:hover:not(:disabled) { 
      background: #1557b0; 
      transform: translateY(-2px); 
    }
    .register-btn:disabled { 
      background: #ccc; 
      cursor: not-allowed; 
      opacity: 0.6;
    }
    .footer { 
      text-align: center; 
      padding: 24px 0; 
      margin-top: auto; 
      border-top: 1px solid rgba(0,0,0,0.1); 
    }
    body.dark .footer { 
      border-top-color: rgba(255,255,255,0.1); 
    }
    .footer a { 
      color: var(--primary-blue); 
      text-decoration: none; 
      font-weight: 500; 
    }
    .modal-overlay { 
      display: none; 
      position: fixed; 
      top: 0; left: 0; 
      width: 100%; height: 100%; 
      background: rgba(0,0,0,0.5); 
      z-index: 1000; 
      align-items: center; 
      justify-content: center; 
      backdrop-filter: blur(5px); 
      animation: fadeIn 0.3s ease; 
    }
    .modal-overlay.show { 
      display: flex; 
    }
    .modal { 
      background: var(--light-bg); 
      padding: 32px; 
      border-radius: 16px; 
      max-width: 400px; 
      width: 90%; 
      box-shadow: 0 20px 60px rgba(0,0,0,0.3); 
      text-align: center; 
      animation: slideUpModal 0.4s ease-out; 
    }
    body.dark .modal { 
      background: var(--dark-gray); 
    }
    @keyframes fadeIn { 
      from { opacity: 0; } 
      to { opacity: 1; } 
    }
    @keyframes slideUpModal { 
      from { opacity: 0; transform: translateY(30px); } 
      to { opacity: 1; transform: translateY(0); } 
    }
    .modal-header h3 { 
      color: var(--primary-blue); 
      font-size: 22px; 
      margin-bottom: 16px; 
    }
    .modal-header p { 
      font-size: 14px; 
      opacity: 0.7; 
      line-height: 1.6; 
      margin-bottom: 16px;
    }
    .info-row { 
      background: rgba(0,0,0,0.05); 
      border-radius: 8px; 
      padding: 12px; 
      margin: 16px 0; 
      text-align: left; 
    }
    body.dark .info-row { 
      background: rgba(255,255,255,0.1); 
    }
    .btn-close { 
      width: 100%; 
      background: var(--primary-blue); 
      color: white; 
      border: none; 
      padding: 12px; 
      border-radius: 8px; 
      cursor: pointer; 
      font-weight: 600; 
      margin-top: 16px; 
      font-size: 15px;
    }
    .btn-close:hover { 
      background: #1557b0; 
      transform: translateY(-1px); 
    }
  </style>
</head>
<body>
  <div class="register-page">
    <button class="theme-toggle" onclick="toggleTheme()" aria-label="Toggle Theme">
      <svg class="theme-icon sun-icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
        <circle cx="12" cy="12" r="5"/>
        <line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/>
        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/>
        <line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/>
        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/>
      </svg>
      <svg class="theme-icon moon-icon" xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"/>
      </svg>
    </button>
   
    <main class="register-main">
      <div class="register-card">
        <h2>Register for Exam Verse</h2>
        <span class="version-capsule">Student Registration</span>
       
        <form id="registerForm">
          <div class="form-group">
            <label for="rollNumber">Roll Number *</label>
            <input type="text" id="rollNumber" required placeholder="Enter your roll number" autocomplete="off" />
            <div class="error-message" id="rollNumberError"></div>
          </div>
          
          <div class="form-group">
            <label for="name">Full Name *</label>
            <input type="text" id="name" required placeholder="Enter your full name" autocomplete="off" />
            <div class="error-message" id="nameError"></div>
          </div>
          
          <div class="form-group">
            <label for="email">Email Address *</label>
            <input type="email" id="email" required placeholder="Enter your email" autocomplete="off" />
            <div class="error-message" id="emailError"></div>
          </div>
          
          <div class="form-group">
            <label for="phone">Phone Number *</label>
            <input type="tel" id="phone" required placeholder="10-digit phone number" pattern="[0-9]{10}" autocomplete="off" />
            <div class="error-message" id="phoneError"></div>
          </div>
          
          <div class="form-group">
            <label for="year">Year of Study *</label>
            <select id="year" required>
              <option value="">Select Year</option>
              <option value="1">1st Year</option>
              <option value="2">2nd Year</option>
              <option value="3">3rd Year</option>
            </select>
            <div class="error-message" id="yearError"></div>
          </div>
          
          <div class="form-group">
            <label for="semester">Semester *</label>
            <select id="semester" required>
              <option value="">Select Semester</option>
              <option value="1">1st Semester</option>
              <option value="2">2nd Semester</option>
              <option value="3">3rd Semester</option>
              <option value="4">4th Semester</option>
              <option value="5">5th Semester</option>
              <option value="6">6th Semester</option>
            </select>
            <div class="error-message" id="semesterError"></div>
          </div>
          
          <div class="form-group fixed">
            <label>Department</label>
            <p style="font-weight: 500; color: var(--primary-blue); margin: 0;">Computer Engineering</p>
            <input type="hidden" id="department" value="Computer Engineering" />
          </div>
          
          <div class="form-group">
            <label for="college">College *</label>
            <select id="college" required>
              <option value="">Select College</option>
              <option value="Government Polytechnic Proddatur">Government Polytechnic Proddatur</option>
              <option value="SVR Engineering College Nandyal">SVR Engineering College Nandyal</option>
              <option value="Other">Other Institution</option>
            </select>
            <div class="error-message" id="collegeError"></div>
          </div>
          
          <div class="form-group">
            <label for="password">Password *</label>
            <input type="password" id="password" required placeholder="Minimum 6 characters" autocomplete="new-password" />
            <div class="error-message" id="passwordError"></div>
          </div>
          
          <div class="form-group">
            <label for="confirmPassword">Confirm Password *</label>
            <input type="password" id="confirmPassword" required placeholder="Re-enter password" autocomplete="new-password" />
            <div class="error-message" id="confirmPasswordError"></div>
          </div>
          
          <button type="submit" class="register-btn" id="registerBtn">Register</button>
        </form>
      </div>
    </main>
   
    <footer class="footer">
      <p>Designed & Developed by <a href="https://www.project-k.co.in" target="_blank">Project K</a></p>
    </footer>
  </div>

  <!-- SUCCESS MODAL -->
  <div class="modal-overlay" id="successModal">
    <div class="modal" onclick="event.stopPropagation()">
      <div class="modal-header">
        <h3>✅ Registration Successful!</h3>
        <p>Your account has been created successfully.</p>
      </div>
      <div class="info-row">
        <strong>Name:</strong> <span id="successName"></span><br/>
        <strong>Roll Number:</strong> <span id="successRoll"></span><br/>
        <strong>College:</strong> <span id="successCollege"></span><br/><br/>
        <small style="color: var(--primary-blue);">Your account is pending admin approval. You'll be notified via email once activated.</small>
      </div>
      <button class="btn-close" onclick="closeModal('successModal')">Close</button>
    </div>
  </div>

  <!-- ERROR MODAL -->
  <div class="modal-overlay" id="errorModal">
    <div class="modal" onclick="event.stopPropagation()">
      <div class="modal-header">
        <h3 style="color: var(--error-red);">❌ Registration Failed</h3>
      </div>
      <div class="info-row" id="errorInfo"></div>
      <button class="btn-close" onclick="closeModal('errorModal')">Try Again</button>
    </div>
  </div>

  <script>
    // PRODUCTION URL (change if your Workers.dev subdomain differs)
    const REGISTER_API = 'https://exam-verse-registration-api.tfi-com-in.workers.dev/api/register-student';

    let isDark = localStorage.getItem('theme') === 'dark';
    if (isDark) document.body.classList.add('dark');

    function toggleTheme() {
      isDark = !isDark;
      document.body.classList.toggle('dark', isDark);
      localStorage.setItem('theme', isDark ? 'dark' : 'light');
    }

    function closeModal(id) {
      document.getElementById(id).classList.remove('show');
    }

    function showSuccess(name, roll, college) {
      document.getElementById('successName').textContent = name;
      document.getElementById('successRoll').textContent = roll;
      document.getElementById('successCollege').textContent = college;
      document.getElementById('successModal').classList.add('show');
    }

    function showError(message) {
      document.getElementById('errorInfo').innerHTML = message;
      document.getElementById('errorModal').classList.add('show');
    }

    function clearErrors() {
      document.querySelectorAll('.error-message').forEach(el => {
        el.classList.remove('show');
        el.textContent = '';
      });
    }

    document.getElementById('registerForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      clearErrors();

      const data = {
        rollNumber: document.getElementById('rollNumber').value.trim(),
        name: document.getElementById('name').value.trim(),
        email: document.getElementById('email').value.trim(),
        phone: document.getElementById('phone').value.trim(),
        year: parseInt(document.getElementById('year').value),
        semester: parseInt(document.getElementById('semester').value),
        department: document.getElementById('department').value,
        college: document.getElementById('college').value,
        password: document.getElementById('password').value,
        confirmPassword: document.getElementById('confirmPassword').value
      };

      // Client-side validation
      let hasError = false;

      if (data.password.length < 6) {
        document.getElementById('passwordError').textContent = 'Password must be at least 6 characters';
        document.getElementById('passwordError').classList.add('show');
        hasError = true;
      }

      if (data.password !== data.confirmPassword) {
        document.getElementById('confirmPasswordError').textContent = 'Passwords do not match';
        document.getElementById('confirmPasswordError').classList.add('show');
        hasError = true;
      }

      if (hasError) return;

      const btn = document.getElementById('registerBtn');
      btn.disabled = true; 
      btn.textContent = 'Registering...';

      try {
        const res = await fetch(REGISTER_API, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify(data)
        });
        
        const result = await res.json();

        if (result.success) {
          showSuccess(data.name, data.rollNumber, data.college);
          document.getElementById('registerForm').reset();
        } else {
          showError(result.message || 'Registration failed. Please try again.');
        }
      } catch (err) {
        console.error('Registration error:', err);
        showError('Network error. Please check your connection and try again.');
      } finally {
        btn.disabled = false; 
        btn.textContent = 'Register';
      }
    });
  </script>
</body>
</html>
